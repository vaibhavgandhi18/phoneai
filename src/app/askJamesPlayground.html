<div>
  <div class="prose dark:text-white-light">
    <h3 class="m-0 font-bold dark:text-white-light">Ask James Playground</h3>
  </div>
  <ul class="flex space-x-2 rtl:space-x-reverse">
    <li>
      <a href="javascript:;" routerLink="/" class="text-primary hover:underline"
        >Dashboard</a
      >
    </li>
    <li class="before:content-['/'] ltr:before:mr-2 rtl:before:ml-2">
      <span>Ask James Playground</span>
    </li>
  </ul>
  <!-- <audio #callerTune>
    <source src="../assets/caller_tune.wav" type="audio/wav" />
  </audio>
  <audio #callLog>
    <source src="../assets/SalesCallLog.wav" type="audio/wav" />
  </audio> -->
  <div class="mt-5 flex justify-between gap-3">
    <div
      *ngIf="callStatus == ''"
      class="panel flex basis-1/4 flex-col items-center justify-center gap-1 rounded-3xl"
    >
      <div class="text-sm text-gray-600">Outgoing call</div>
      <div class="text-center text-lg font-semibold">Ask James</div>
      <div
        class="mt-2 flex h-24 w-24 items-center justify-center rounded-full border border-gray-100"
      >
        <div
          class="flex h-20 w-20 items-center justify-center rounded-full border border-gray-200"
        >
          <div
            class="flex h-16 w-16 items-center justify-center rounded-full border border-gray-400"
          >
            <img
              class="h-16 w-16 rounded-full"
              src="../assets/images/profile-bot.avif"
            />
          </div>
        </div>
      </div>

      <!-- <div class="timer mt-2" [class.showTimer]="callStatus == 'ended'">
        <div *ngIf="callStatus == 'ended'">
          Call Ended: {{ getFormattedTime() }}
        </div>
      </div> -->
      <div class="mt-3 flex w-full items-center justify-evenly">
        <div class="phone-icon cursor-pointer" (click)="clearTimer()">
          <icon-phone-call-cancel class="h-9 w-9" [fillColor]="'red'" />
        </div>
        <icon-phone-mute class="h-6 w-6" [fill]="true" />
        <div class="phone-icon cursor-pointer" (click)="startTimer()">
          <icon-phone-call
            class="phone-icon h-8 w-8 text-green-500"
            [fill]="true"
          />
        </div>
      </div>
    </div>
    <div *ngIf="callStatus != ''" class="grid flex-1 grid-cols-3 gap-3">
      <div class="col-span-2 flex justify-between gap-3">
        <div class="panel flex flex-1 flex-col p-0">
          <div
            class="flex items-center justify-between border-b p-3 text-lg font-semibold"
          >
            <div class="flex items-center gap-3">
              <div class="rounded-lg border border-blue-700 bg-blue-600 p-1">
                <icon-phone-call class="h-6 w-6 text-white" />
              </div>
              <div>Ask James</div>
            </div>

            <div
              *ngIf="callStatus == 'started'"
              class="timer"
              [class.showTimer]="callStatus == 'started'"
            >
              <div>{{ getFormattedTime() }}</div>
            </div>
            <div *ngIf="callStatus == 'ended'">{{ getFormattedTime() }}</div>
            <button
              *ngIf="callStatus == 'started'"
              type="button"
              class="btn btn-primary rounded-full bg-green-900 text-white"
            >
              Connected
            </button>
            <button
              *ngIf="callStatus == 'ended'"
              type="button"
              class="btn btn-primary rounded-full bg-gray-700 text-white"
            >
              Call Ended
            </button>
          </div>
          <ng-scrollbar style="height: calc(100vh - 30vh) !important">
            <div class="p-3" *ngIf="callStatus == 'started'">
              <strong>Call established ...</strong>
            </div>
            <div
              class="p-3"
              *ngFor="let message of displayedMessages"
              [ngClass]="message.sender"
            >
              <strong>{{ message.sender }}:</strong> {{ message.displayedText }}
            </div>
          </ng-scrollbar>
        </div>
      </div>
      <div class="col-span-1 flex flex-col justify-between gap-3">
        <div class="panel flex flex-col p-0">
          <div class="border-b p-4.5 text-lg font-semibold">
            Call Participants
          </div>
          <div class="p-5">
            <div class="flex justify-items-start gap-3">
              <div class="h-5 w-5 rounded-full bg-blue-600"></div>
              <div class="-mt-1 flex flex-col">
                <div class="text-base">Nick</div>
                <div class="text-sm">+1(425)-232-1000</div>
              </div>
            </div>
            <div class="mt-3 flex justify-items-start gap-3">
              <div class="h-5 w-5 rounded-full bg-blue-600"></div>
              <div class="-mt-1 flex flex-col">
                <div class="text-base">Ask James</div>
                <div class="text-sm">+1(255)-789-5050</div>
              </div>
            </div>
          </div>
        </div>
        <div
          class="panel flex flex-1 flex-col p-0"
          *ngIf="callStatus == 'ended'"
        >
          <div class="border-b p-4.5 text-lg font-semibold">Call Summary</div>
          <div class="p-5" *ngIf="summary">
            The call is a notification from the AT&T Mobility National Dispatch
            Center to Nick regarding a critical severity ticket
            (TT00000080509243) assigned to him. The issue involves two
            10-gigabit network links being down since July 29, 2024, affecting
            69 sites operating in simplex mode. The location of the issue is 157
            Houston Cir, Idaho Falls, ID 83402. Nick acknowledges the ticket and
            confirms he has all necessary information to proceed.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
